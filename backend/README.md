# 명부검증 백엔드 API

명부 데이터를 검증하는 FastAPI 기반 백엔드 서버입니다.

## 프로젝트 구조

```
backend/
├── main.py                 # FastAPI 애플리케이션 진입점
├── requirements.txt        # Python 패키지 의존성
├── .env.example           # 환경 변수 예시
├── api/
│   ├── __init__.py
│   └── routes.py          # API 엔드포인트
├── services/
│   ├── __init__.py
│   ├── excel_reader.py    # 엑셀 파일 읽기
│   ├── data_mapper.py     # 데이터 매핑 및 정형화
│   └── validator.py       # 데이터 검증
├── models/
│   ├── __init__.py
│   └── schemas.py         # 데이터 모델
└── data/                  # 샘플 데이터
```

## 설치 및 실행

### 1. 가상 환경 생성 (권장)

```bash
python -m venv venv
source venv/bin/activate  # Windows: venv\Scripts\activate
```

### 2. 패키지 설치

```bash
pip install -r requirements.txt
```

### 3. 환경 변수 설정 (선택)

```bash
cp .env.example .env
# .env 파일을 수정하여 필요한 설정 변경
```

### 4. 서버 실행

```bash
python main.py
```

또는

```bash
uvicorn main:app --reload --host 0.0.0.0 --port 8000
```

서버가 실행되면 다음 URL에서 접근 가능합니다:
- API: http://localhost:8000
- API 문서 (Swagger): http://localhost:8000/docs
- API 문서 (ReDoc): http://localhost:8000/redoc

## API 엔드포인트

### 1. 파일 업로드
- **POST** `/api/upload`
- 엑셀 파일을 업로드하고 기본 정보를 반환합니다.

### 2. 데이터 검증
- **POST** `/api/validate`
- 엑셀 파일을 업로드하고 전체 검증을 수행합니다.

### 3. 헬스 체크
- **GET** `/health`
- 서버 상태를 확인합니다.

## 처리 대상 시트

다음 시트들을 **키워드 기반으로** 자동 인식하여 읽고 처리합니다:

1. **재직자 명부** (필수)
   - 예: "재직자 명부", "(2-2)재직자 명부", "2-2 재직자명부" 등
   
2. **퇴직자 및 DC전환자 명부** (필수)
   - 예: "퇴직자 및 DC전환자 명부", "(2-4)퇴직자 및 DC전환자 명부" 등
   
3. **추가 명부(장기근속)** (필수)
   - 예: "추가 명부(장기근속)", "(2-5)추가명부", "추가명부" 등
   
4. **기타장기 재직자 명부** (선택사항)
   - 예: "기타장기 재직자 명부", "(2-3) 기타장기 재직자 명부" 등
   - 파일에 없어도 오류 발생하지 않음

**📌 시트 이름 인식 특징:**
- 번호(2-2, 2-3 등)가 있어도 없어도 인식 가능
- 공백, 괄호 등 특수문자 무시하고 키워드로 인식
- 대소문자 구분 없음
- 유사한 이름도 자동 매칭

## 데이터 처리 흐름

1. **파일 업로드**: 프론트엔드에서 엑셀 파일 업로드
2. **엑셀 읽기**: `ExcelReader`가 필요한 시트들을 읽어옴
3. **데이터 매핑**: `DataMapper`가 데이터를 정형화하고 매핑
4. **데이터 검증**: `DataValidator`가 검증 규칙을 적용
5. **결과 반환**: 검증 결과를 JSON으로 반환

## 향후 개발 사항

- [ ] 실제 컬럼 매핑 규칙 구현
- [ ] 데이터 정형화 로직 구체화
- [ ] 검증 규칙 상세 구현
- [ ] 오류 메시지 한글화
- [ ] 배치 처리 기능
- [ ] 결과 리포트 생성
- [ ] 데이터베이스 연동 (필요시)

## 개발 노트

현재 구조는 기본 뼈대만 구현되어 있으며, 다음 작업이 필요합니다:

1. **매핑 규칙 정의**: 실제 엑셀 컬럼명과 표준 컬럼명 매핑
2. **정형화 규칙**: 사원번호, 생년월일 등의 형식 통일
3. **검증 규칙**: 필수 필드, 데이터 타입, 범위 등 검증

